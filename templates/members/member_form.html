{% extends "_base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block title %}{% if form.instance.pk %}Update{% else %}Create{% endif %}Member Information{% endblock %}
{% block main %}
<div class="container">
    <div class="mx-auto wow bounceInUp rounded my-3" 
        style="background-image: url('{% static "img/heroAccount-13.png" %}');background-size: cover; background-position: center center; background-repeat: no-repeat; " alt="Church-at" data-wow-delay="0.1s">
        <div class="container py-1 mt-0">
            <div class="animated bounceInDown ">
                <ol class="breadcrumb justify-content-start mb-0 animated bounceInDown">
                    <li class="small"><a href="{% url 'pages:homepage' %}">Home <span class="px-1">\</span></a></li>
                    <li class="small"> <a href="{% url "members:member_list" %}">memberInformation<span class="px-1">\</span></a></li>

                    {% comment %} {% if not form.instance.pk %}
                    <li class="small"> <a href="{% url "members:member_create" %}">membersCreate <span class="px-1">\</span></a></li>
                    {% else %}
                    <li class="small"> <a href="{% url "members:member_update" %}">membersUpdate <span class="px-1">\</span></a></li> 
                    {% endif %} {% endcomment %}
                    <li class="small" aria-current="page">{% if form.instance.pk %}Update{% else %}Create{% endif %}Member Information</li>
                </ol>
                
            </div>
        
        </div>
        <div class="text-center py-2">
            <h3 class="mb-2 bolder text-light ">የአባልነት መረጃ </h3>
            <h3 class="mb-2 text-light ">Membership Information</h3>
            <small>ከዚህ በታች የተዘረዘሩትን መጠየቆች ለቤተክርስቲያኖች መረጃ የረዳን ዘንድ አሁን ያሉበትን ትክክለኛ አድራሻ ስልክ ቁጥርና የቤተሰብ የተሟላ የቤተሰብ መረጃ ይሞሉልን ዘንድ አንጠይቃለን ።</small>
            <p class="small">To assist our church, kindly provide your current address, phone number, and family details by completing the attached questionnaire.</small>
        </div>
    </div>
    <h2>{% if form.instance.pk %}Update{% else %}Create{% endif %} Member Information</h2>
    <form method="post" class="needs-validation" novalidate>
        {% csrf_token %}
        {{ form.non_field_errors }}
        <div class="mb-3">
            {{ form.full_name|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.baptismal_name|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.godfather|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.address|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.city|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.state|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.zip_code|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.apartment|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.telephone_number|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.email|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.marital_status|as_crispy_field }}
        </div>
        <div class="mb-3 spouse-fields {% if not form.instance.marital_status == 'married' %}d-none{% endif %}">
            {{ form.spouse_name|as_crispy_field }}
        </div>
        <div class="mb-3 spouse-fields {% if not form.instance.marital_status == 'married' %}d-none{% endif %}">
            {{ form.spouse_baptismal_name|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.how_mony_children|as_crispy_field }}
        </div>
        <div class="mb-3">
            {{ form.how_mony_relatives|as_crispy_field }}
        </div>
        <div class="mb-3 children-fields {% if form.instance.how_mony_children == 0 %}d-none{% endif %}">
            {{ children.management_form }}
            {% for childs in form.how_mony_children %}
                {% for child in children %}
                <div class="form-row">
                    {{ child.name|as_crispy_field }}
                    
                </div>
                {% endfor %}
            {% endfor %}
        </div>
        <div class="mb-3 relatives-fields {% if not form.instance.how_mony_relatives == 0 %}d-none{% endif %}">
            
        </div>
        <h4>Children</h4>
        {{ children.management_form }}
        {% for child in children %}
            <div class="form-row">
                {{ child.name|as_crispy_field }}
                
            </div>
        {% endfor %}
        
        <h4>Relatives</h4>
        {{ relatives.management_form }}
        {% for relative in relatives %}
            <div class="form-row">
                {{ relative.name|as_crispy_field }}
                {{ relative.relationship|as_crispy_field }}
                
            </div>
        {% endfor %}
        
        <button type="submit" class="btn btn-primary mt-3">Save</button>
    </form>

</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const maritalStatusRadios = document.querySelectorAll('input[name="marital_status"]');
        const spouseFields = document.querySelectorAll('.spouse-fields');
        

        function toggleSpouseFields() {
            const selectedStatus = document.querySelector('input[name="marital_status"]:checked').value;
            if (selectedStatus === 'married') {
                spouseFields.forEach(field => field.classList.remove('d-none'));
            } else {
                spouseFields.forEach(field => field.classList.add('d-none'));
            }
        }

        maritalStatusRadios.forEach(radio => {
            radio.addEventListener('change', toggleSpouseFields);
        });

        // Initialize on page load
        toggleSpouseFields();
    });
</script>
{% endblock %}