{% extends "_base.html" %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'css/quizzes.css' %}">
{% endblock %}
{% block javascript %}
   {% comment %} <script type="text/javascript" src="{% static '' %}" defer ></script> {% endcomment %}
{% endblock %}
{% block title %}youth School {% endblock %}
{% block main %}
<div class=" ">
      <!-- Service Start -->
    <div class="service ">
        <div class="mx-0 py-2  wow bounceInUp" height="100%"
            style="background-image: url('{% static "img/heroAccount-13.png" %}');background-size: cover; background-position: center center; background-repeat: no-repeat; " alt="Church-at" data-wow-delay="0.1s">
             <!-- breadcrumb Start -->
             <div class="container animated bounceInDown py-1 mt-0">
                <div class=" ">
                    <ol class="breadcrumb justify-content-start mb-0 ">
                        <li class="small"><a href="{% url 'pages:homepage' %}">Home <span class="px-1">\</span></a></li>
                        <li class="small"><a href="{% url 'schools:school' %}">Schools<span class="px-1">\</span></a></li>
                        <li class="small" aria-current="page">youthSchool</li>
                    </ol>
                </div>
            </div>
            <!-- breadcrumb Start -->
            <div class="text-center ">
                {% comment %} <div class="text-center py-4">
                    <small class="d-inline-block fw-bold text-dark text-uppercase bg-light border border-primary rounded-pill px-4 py-1 mb-3">
                        <i class="fas fa-school fa-3x text-primary mb-4 text-center px-2"></i>
                        Sunday School for Youth</small>
                </div> {% endcomment %}
                <h3 class="mb-3 bolder text-light">ለወጣቶች አብነት ትምህርት</h3>
                <h3 class="mb-3 text-light ">Sunday Youth School</3>
            </div>
            
        </div>
        <div class="container py-3">
            <div class="row g-4">
                <div class="col-lg-12 col-md-12 col-sm-12 wow bounceInUp " data-wow-delay="0.5s">
                    <div class="bg-light rounded service-item">
                        <div class="service-content-1 p-1">
                            <div class="service-content-icon text-center">
                                <!-- Nav tabs -->
                                <ul class="nav nav-tabs small" id="myTab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="CoursesQuizzes-tab" data-bs-toggle="tab" data-bs-target="#CoursesQuizzes" type="button" role="tab" aria-controls="CoursesQuizzes" aria-selected="true">Courses & Quizzes</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="Reports-tab" data-bs-toggle="tab" data-bs-target="#Reports" type="button" role="tab" aria-controls="Reports" aria-selected="false">Reports</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="FAQ-tab" data-bs-toggle="tab" data-bs-target="#FAQ" type="button" role="tab" aria-controls="FAQ" aria-selected="false">FAQ</button>
                                    </li>
                                    {% comment %} <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false">Settings</button>
                                    </li> {% endcomment %}
                                </ul>
                                
                                <!-- Tab panes -->
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="CoursesQuizzes" role="tabpanel" aria-labelledby="CoursesQuizzes-tab">
                                        <div class="container py-5">
                                            <div class="row row-cols-1 row-cols-md-2 g-4">
                                                {% for course in courses %}
                                                <div class="col">
                                                    <div class="card shadow border-warning-church">
                                                        {% if course.image %}
                                                            <div class="m-1 wow bounceInUp" height="100%"
                                                                style="padding: 100px 0px; background-image: url('{{course.image.url}} '); background-size: cover; background-position: center top; background-repeat: no-repeat; " alt="Church-at" data-wow-delay="0.1s">
                                                                {% comment %} <img width="600" height="200" src="{{ course.image.url }}" alt="Logo" class="img-fluid" >  {% endcomment %}
                                                                <div class="text-center ">
                                                                    <h3 class="mb-3 bolder text-light">{{ course.title }}</h3>
                                                                </div>
                                                            </div>
                                                        {% else %}
                                                            <img src="{% static "img/Courses-palceHlder.png" %}" class="card-img-top" alt="Mystery-of-the-Holy-Communion">
                                                        {% endif %}
                                                        <div class="card-body">
                                                            {% if user.is_authenticated %}
                                                            {% if progress %}
                                                                {% for progress in progress %}
                                                                    {% if progress.course.title == course.title %}
                                                                        <div class="progress mx-2 my-2" style="height: 30px;">
                                                                            {% if progress.is_chapter_completed and progress.is_quiz_completed %}
                                                                                <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                                                                    {{ course.title }} 100% successfully completed
                                                                                </div>
                                                                            {% elif progress.is_chapter_completed %}
                                                                                <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">
                                                                                    You completed reading the course but you need to take the quiz for 100% successful completion.
                                                                                </div>
                                                                            {% else %}
                                                                                <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                                                                    0% progress, you need to start taking the courses
                                                                                </div>
                                                                            {% endif %}
                                                                        </div>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            {% endif %}
                                                            {% endif %}
                                                        </div>
                                                        <div class="card-body">
                                                            <nav>
                                                                <div class="nav nav-tabs small" id="nav-tab-{{ forloop.counter }}" role="tablist">
                                                                  <button class="nav-link active" id="nav-home-tab-{{ forloop.counter }}" data-bs-toggle="tab" data-bs-target="#nav-home-{{ forloop.counter }}" type="button" role="tab" aria-controls="nav-home-{{ forloop.counter }}" aria-selected="true">
                                                                    <small>{{ course.title }}</small>
                                                                  </button>
                                                                  <button class="nav-link small" id="nav-profile-tab-{{ forloop.counter }}" data-bs-toggle="tab" data-bs-target="#nav-profile-{{ forloop.counter }}" type="button" role="tab" aria-controls="nav-profile-{{ forloop.counter }}" aria-selected="false">
                                                                    {% if progress %}
                                                                        {% for progres in progress %}
                                                                            {% if progres.course.title == course.title %}
                                                                                {% if progres.is_chapter_completed and progres.is_quiz_completed %}
                                                                                RESULT
                                                                                {% else %}
                                                                                QUIZZES
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                    {% else %}
                                                                    QUIZZES
                                                                    {% endif %} 
                                                                  </button>
                                                                  <button class="nav-link" id="nav-contact-tab-{{ forloop.counter }}" data-bs-toggle="tab" data-bs-target="#nav-contact-{{ forloop.counter }}" type="button" role="tab" aria-controls="nav-contact-{{ forloop.counter }}" aria-selected="false">Quations & Ansewr</button>
                                                                </div>
                                                              </nav>
                                                              <div class="tab-content" id="nav-tabContent">
                                                                <div class="tab-pane fade show active " id="nav-home-{{ forloop.counter }}" role="tabpanel" aria-labelledby="nav-home-tab-{{ forloop.counter }}">
                                                                    <div class="card-body text-start border rounded my-3">
                                                                        <h6 class="card-title py-2">{{ course.title }}</h6>
                                                                        <small class="text-primary">
                                                                            {{ course.description }}
                                                                        </small>
                                                                    </div>
                                                                    <div class="card-body text-start border rounded my-2">
                                                                        <div class="chapter_data accordion-flush" id="accordionFlushExample-{{ forloop.counter }}">
                                                                            {% for chapter_data in chapters_with_resources %}
                                                                                {% if chapter_data.chapter.course.title == course.title %}
                                                                                    <div class="accordion-item">
                                                                                        <h4 class="accordion-header" id="flush-heading-{{ forloop.counter }}">
                                                                                            <button class="accordion-button collapsed " type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse-{{ forloop.counter }}" aria-expanded="false" aria-controls="flush-collapse-{{ forloop.counter }}">
                                                                                                <i class="fas fa-cross pe-3 text-primary"></i>   
                                                                                                <small>{{ chapter_data.chapter.chapter_title }}</small>                                                                    
                                                                                            </button>
                                                                                        </h4>
                                                                                        <div id="flush-collapse-{{ forloop.counter }}" class="accordion-collapse collapse py-2" aria-labelledby="flush-heading-{{ forloop.counter }}" data-bs-parent="#accordionFlushExample-{{ forloop.counter }}">
                                                                                            <div class="accordion-body small text-start  border rounded">
                                                                                                {{ chapter_data.chapter.content }}
                                                                                            </div>
                                                                                            {% if chapter_data.chapter.audio_file %}
                                                                                            <div class="accordion-body small text-start border rounded my-2">
                                                                                                <h6 class="card-title py-2">Lison the audio about the topic</h6>
                                                                                                <audio controls>
                                                                                                    <source src="{{ chapter_data.chapter.audio_file.url }}" type="audio/mpeg">
                                                                                                    Your browser does not support the audio element.
                                                                                                </audio>
                                                                                            </div>
                                                                                            {% endif %}  
                                                                                            {% if chapter_data.chapter.video_url %}
                                                                                            <div class="accordion-body small text-start border rounded my-2">
                                                                                                <h6 class="card-title py-2">View the video about the subject matter. | ስለ ርዕሰ ጉዳዩ ቪዲዮውን ይመልከቱ.</h6>
                                                                                                <iframe width="400"  height="250" class="rounded mx-2"
                                                                                                    src="{{ chapter_data.chapter.video_url }}?rel=0" 
                                                                                                    title="2019 የትንሳኤ ጥዑመ  ዝማሬ" 
                                                                                                    frameborder="0" 
                                                                                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                                                                                                    allowfullscreen>
                                                                                                </iframe>
                                                                                                
                                                                                            </div>
                                                                                            {% endif %} 
                                                                                            
                                                                                            {% if chapter_data.resources %}
                                                                                            <div class="accordion-body small text-start border rounded my-2">
                                                                                                <h6 class="card-title py-2">
                                                                                                    If you seek further exploration of this topic, the following resources come highly recommended:
                                                                                                </h6>
                                                                                                <div class="d-flex flex-column align-items-start px-3">
                                                                                                    
                                                                                                    {% for resource in chapter_data.resources %}
                                                                                                        <a class="text-body mb-3" 
                                                                                                        title="{{resource.Resources_title}}" 
                                                                                                        href="{{ resource.links }}"  target="_blank">
                                                                                                        <span>({{ forloop.counter }})</span> {{resource.Resources_title}} <i class="fas fa-external-link-alt text-primary px-2"></i></a>
                                                                                                    {% endfor %}
                                                                                                </div>
                                                                                            </div>
                                                                                            {% endif %}
                                                                                        </div>
                                                                                        
                                                                                    </div>
                                                                                {% endif %}
                                                                            {% endfor %}
                                                                            {% if progress %}
                                                                            {% for progres in progress %}
                                                                            {% if progres.course.title == course.title %}
                                                                            {% if progres.is_chapter_completed %}
                                                                            {% comment %} let you re-take {% endcomment %}
                                                                            <form method="post" action="{% url "schools:youthSchool" %}">
                                                                                {% csrf_token %}  
                                                                                <input type="hidden" name="course_id_retake" value="{{course.id}}">
                                                                                <button class="btn btn-sm btn-outline-primary my-3 d-none" type="submit">Are you sure you want retake the Quiz?</button>
                                                                            </form> 
                                                                            {% else %}
                                                                            {% comment %} requist to take for the first time {% endcomment %}
                                                                            <form method="post" action="{% url "schools:youthSchool" %}">
                                                                                {% csrf_token %}  
                                                                                <input type="hidden" name="course_id" value="{{course.id}}">
                                                                                <button class="btn btn-sm btn-outline-primary my-3" type="submit">Are you ready to take a Quiz?</button>
                                                                            </form> 
                                                                            {% endif %}
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% endif %}  
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" id="nav-profile-{{ forloop.counter }}" role="tabpanel" aria-labelledby="nav-profile-tab-{{ forloop.counter }}">
                                                                    {% comment %} quiz or result {% endcomment %}
                                                                    {% if progress %}
                                                                        {% for progres in progress %}
                                                                            {% if progres.course.title == course.title %}
                                                                                {% if progres.is_chapter_completed and progres.is_quiz_completed %}
                                                                                {% comment %} Result View {% endcomment %}
                                                                                    {% if results %}
                                                                                        {% for result in results %}
                                                                                            {% if result.quiz.chapter.course.title == course.title %}
                                                                                            <div>
                                                                                                <div class="row g-2 my-2">
                                                                                                    <div class="col-12 border rounded p-3" data-wow-delay="0.0s" style="visibility: visible; animation-delay: 0.0s; animation-name: bounceInUp;">
                                                                                                        <div class="menu-item d-flex align-items-center">
                                                                                                            {% if result.is_pass %}
                                                                                                            <img class="flex-shrink-0 img-fluid rounded-circle mx-auto" src="{% static "img/icon/achievementQuizChurch Logo.png" %}" alt="100x100-placeholder">
                                                                                                            {% endif %}
                                                                                                            <div class="w-100 d-flex flex-column text-start ">
                                                                                                                {% if result.is_pass %}
                                                                                                                <div class="d-flex justify-content-between border-bottom border-primary pb-2 mb-2 mx-2">
                                                                                                                    <h6 class="text-primary small">Status : 
                                                                                                                        <span class="badge rounded-pill text-success">YOU PASSED</span>
                                                                                                                    </h6>
                                                                                                                
                                                                                                                </div>
                                                                                                                <div class="d-flex flex-column align-items-start mx-2">
                                                                                                                    <h6 class="text-primary small">Score: {{ result.score|floatformat:"0" }} / 5 Questions</h6>
                                                                                                                    <h6 class="text-primary small">Name : {{user.username}}</h6>
                                                                                                                    <h6 class="text-primary small mb-2">Date : {{ result.updated_at|date}}</h6>
                                                                                                                </div>
                                                                                                                {% else %}
                                                                                                                <div class="d-flex justify-content-between border-bottom border-primary pb-2 mb-2">
                                                                                                                    <h6 class="text-primary">Status : 
                                                                                                                        <span class="badge rounded-pill text-danger">YOU NOT PASSED</span>
                                                                                                                    </h6>
                                                                                                                    <h6 class="text-primary mx-4">{% comment %} let you re-take {% endcomment %}
                                                                                                                        <form method="post" action="{% url "schools:youthSchool" %}">
                                                                                                                            {% csrf_token %}  
                                                                                                                            <input type="hidden" name="course_id_retake" value="{{course.id}}">
                                                                                                                            <button class="btn btn-sm btn-outline-primary" type="submit">Retake the Quiz?</button>
                                                                                                                        </form> 
                                                                                                                    </h6>
                                                                                                                </div>
                                                                                                                <div class="d-flex flex-column align-items-start">
                                                                                                                    <h6 class="text-primary small">Score : {{ result.score|floatformat:"0" }} / 5 Questions</h6>
                                                                                                                    <h6 class="text-primary small">Name : {{user.username}}</h6>
                                                                                                                    <h6 class="text-primary small mb-2">Date : {{ result.updated_at|date}}</h6>
                                                                                                                    
                                                                                                                </div>
                                                                                                                {% endif %}
                                                                                                                
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="col-12 border rounded p-3">
                                                                                                        <h6 class="text-primary text-start">Resource for more reading:</h6>
                                                                                                            <div class="d-flex flex-column align-items-start px-3">
                                                                                                                {% for chapter_data in chapters_with_resources %} 
                                                                                                                    {% for resource in chapter_data.resources %}
                                                                                                                        {% if resource.chapter.course.title == course.title  %}
                                                                                                                        <a class="text-body mb-3 small" 
                                                                                                                            title="{{resource.Resources_title}}" 
                                                                                                                            href="{{ resource.links }}"  
                                                                                                                            target="_blank">
                                                                                                                            <i class="fa fa-check text-primary me-2" style="font-size: 10px; color:#D4A762;"></i> 
                                                                                                                            {{resource.Resources_title}} 
                                                                                                                            <i class="fas fa-external-link-alt text-primary px-2" style="font-size: 10px; color:#D4A762;"></i>
                                                                                                                        </a>
                                                                                                                        {% endif %}
                                                                                                                    {% endfor %}
                                                                                                                {% endfor %}
                                                                                                            </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            {% endif %}
                                                                                        {% endfor %}
                                                                                    {% endif %}
                                                                                {% else %}
                                                                                {% comment %} quiz {% endcomment %}
                                                                                <div class="text-start border rounded p-3">
                                                                                    {% for chapter_data in chapters_with_resources %}
                                                                                    {% if chapter_data.quizzes %}
                                                                                    {% for quiz in chapter_data.quizzes %}
                                                                                    {% if quiz.chapter.course.title == course.title %}
                                                                                        <h4 class="py-2 text-center">{{ quiz.quiz_title }}</h4>
                                                                                        <form method="post" action="{% url "schools:youthSchool" %}">
                                                                                            {% csrf_token %}
                                                                                            <input type="hidden" name="quiz_id" value="{{ quiz.id }}">
                                                                                        
                                                                                                {% for question in chapter_data.questions %}
                                                                                                    {% if question.quiz_id == quiz.id %}
                                                                                                        <h6 class="py-2"> {{forloop.counter}}) 
                                                                                                            <span class="mx-2">{{ question.text }}</span></h6>
                                                                                                    
                                                                                                            {% for answer in question.answer_set.all %}
                                                                                                                <p class="h6 text-dark small py-2 mx-3">
                                                                                                                    <input class="option-input radio" 
                                                                                                                    type="radio" 
                                                                                                                    name="question{{ question.id }}" 
                                                                                                                    value="{{ answer.id }}">
                                                                                                                    <span class="px-2">{{ answer.text }}</span>
                                                                                                                </p>
                                                                                                            {% endfor %}
                                                                                                        
                                                                                                    {% endif %}
                                                                                                {% endfor %}
                                                                                            <div class="d-grid gap-2 col-6 mx-auto">
                                                                                                <button class="btn btn-sm btn-outline-primary" type="submit">Submit Quiz</button>
                                                                                            </div>    
                                                                                        </form>
                                                                                    {% endif %}
                                                                                    {% endfor %}
                                                                                    {% endif %}
                                                                                    {% endfor %}
                                                                                </div>
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                    {% endif %} 
                                                                </div>
                                                                <div class="tab-pane fade" id="nav-contact-{{ forloop.counter }}" role="tabpanel" aria-labelledby="nav-contact-tab-{{ forloop.counter }}">
                                                                    Quations & Ansewr
                                                                </div>
                                                              </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="Reports" role="tabpanel" aria-labelledby="Reports-tab">Reports</div>
                                    <div class="tab-pane fade" id="FAQ" role="tabpanel" aria-labelledby="FAQ-tab">FAQ</div>
                                    {% comment %} <div class="tab-pane fade" id="FAQ" role="tabpanel" aria-labelledby="settings-tab">settings</div> {% endcomment %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Service End -->
</div>
{% endblock %}